import{d as q,j as g,o as u,c,w as b,a as S,t as M,u as r,K as T,f,U as I,B as O,Q as N,r as j,e as y,i as v,F as A,k as B,b as C,q as U,n as _,I as E,R as L,_ as Q}from"./index-vMEhzMSc.js";import{T as K}from"./TaskStepInstructionList-wQNbcGEe.js";const F=q({__name:"QuestionSection",props:{question:{},answer:{type:[String,Number,Boolean,Object]}},emits:["update:answer"],setup(p,{emit:m}){const l=p,d=N,a=m,i=g({get:()=>l.answer,set:e=>{a("update:answer",e)}});return(e,t)=>(u(),c(r(O),{title:e.question.title},{default:b(()=>[S("p",null,M(e.question.question),1),e.question.type===r(d).TEXT?(u(),c(r(T),{key:0,id:e.question.id,modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s),label:"Antwort"},null,8,["id","modelValue"])):f("",!0),e.question.type===r(d).SINGLE_CHOICE?(u(),c(r(I),{key:1,id:e.question.id,modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=s=>i.value=s),label:"Antwort",options:e.question.options||[]},null,8,["id","modelValue","options"])):f("",!0)]),_:1},8,["title"]))}}),G=q({__name:"ActivitySurvey",props:{taskStep:{},sensors:{}},emits:["submit"],setup(p,{emit:m}){const l=p,d=m,a=j({});for(const[e,t]of l.taskStep.questions)a.value[e]=t.clone();const i=async()=>{const t=await l.sensors.get(E.GEOLOCATION).getLocation(),s=[];for(const[w,n]of Object.entries(a.value)){const o=new L;if(o.addMeta("latitude",t.coords.latitude),o.addMeta("longitude",t.coords.longitude),o.addMeta("accuracy",t.coords.accuracy),o.addMeta("questionId",n.id),o.addMeta("type",n.type),o.addMeta("question",n.question),o.addMeta("questionTitle",n.title),n.answer&&typeof n.answer!="object")o.addMeasurement(w,n.answer);else if(n.answer)for(const[k,V]of Object.entries(n.answer))o.addMeasurement(k,V);s.push(o)}d("submit",s)};return(e,t)=>(u(),y("div",null,[v(K,{title:e.taskStep.title,description:e.taskStep.description,instructions:e.taskStep.instructions},null,8,["title","description","instructions"]),S("form",{class:"survey-section",onSubmit:_(i,["prevent"])},[(u(!0),y(A,null,B(Object.keys(a.value),s=>(u(),c(F,{key:s,answer:a.value[s].answer,"onUpdate:answer":w=>a.value[s].answer=w,question:a.value[s]},null,8,["answer","onUpdate:answer","question"]))),128)),v(r(U),{type:"submit",style:{"--color-surface-button":"var(--color-primary)"}},{default:b(()=>[C(" Weiter ")]),_:1})],32)]))}}),h=Q(G,[["__scopeId","data-v-1977c2ba"]]);export{h as default};
