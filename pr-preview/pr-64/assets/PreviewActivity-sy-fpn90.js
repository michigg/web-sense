import{d as z,f as C,r as u,j as F,o as n,e as c,h as m,u as a,M as P,c as p,D as I,i as B,k as L,v as R,a as i,w as V,F as v,m as q,B as N}from"./index-yB2zXo3B.js";import{u as g}from"./useEntityState-D1fPZdll.js";import{B as K,M as T,A as Z}from"./ButtonSoundAnimation-3Wc8Bisu.js";import{K as j}from"./KeyValueListItem-llaNNldo.js";const U=i("label",{for:"recording-time-input"},"Aufnahmezeit in Sekunden",-1),G={key:1},H=i("h2",null,"Ergebnisse",-1),Y=z({__name:"PreviewActivity",props:{sensor:{}},setup(w){const d=w,{busy:h,setBusy:D,setIdle:b,error:A,setError:S}=g();C(async()=>{if(D(),await d.sensor.getPermission()==="denied"){S(new Error("Zugriff auf das Microphone verweigert."));return}b()});const o=u(1),{busy:y,setBusy:M,setIdle:_,error:J,setError:E,clearError:k}=g(),l=u(),f=u();F(y,e=>{f.value=e?"Zeichne auf":"Live Preview starten"},{immediate:!0});const x=async()=>{M(),k();try{const e=d.sensor,s=new T(e);console.info("micAnalyzer created");const r=await s.analyze(o.value),t=Z.getResult(r.getAmplitudeSpectrumList(),e.sampleRate,e.bufferSize);l.value={sampleRate:e.sampleRate,bufferSize:e.bufferSize,windowingFunction:s.analysisConfig.windowingFunction,lowestPerceptibleFrequency:s.analysisConfig.lowestPerceptibleFrequency,highestPerceptibleFrequency:s.analysisConfig.highestPerceptibleFrequency,minDBA:t.minDBA,maxDBA:t.maxDBA,averageDBA:t.averageDBA,minDB:t.minDB,maxDB:t.maxDB,averageDB:t.averageDB}}catch(e){console.error(e),E(e)}finally{_()}};return(e,s)=>(n(),c(v,null,[m(a(P),{error:a(A)},null,8,["error"]),a(h)?(n(),p(a(I),{key:0,title:"Sensorvorschau wird geladen"})):B("",!0),U,L(i("input",{id:"recording-time-input","onUpdate:modelValue":s[0]||(s[0]=r=>o.value=r),type:"number",min:"1",step:"1"},null,512),[[R,o.value]]),i("div",null,[m(K,{busy:a(y),info:f.value,onClick:x},null,8,["busy","info"])]),l.value?(n(),c("section",G,[H,m(a(N),null,{default:V(()=>[(n(!0),c(v,null,q(l.value,(r,t)=>(n(),p(j,{key:t,"key-data":t,"value-data":r},null,8,["key-data","value-data"]))),128))]),_:1})])):B("",!0)],64))}});export{Y as default};
