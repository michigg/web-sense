import{d as q,s as V,o as u,c,w as b,a as S,t as M,u as r,K as T,g as f,U as I,A as O,Q as A,r as C,e as y,f as v,F as N,m as B,b as E,C as U,E as _,I as j,R as L,_ as Q}from"./index-Cs5H5E-P.js";import{T as K}from"./TaskStepInstructionList-Bt8Qa81M.js";const F=q({__name:"QuestionSection",props:{question:{},answer:{type:[String,Number,Boolean,Object]}},emits:["update:answer"],setup(p,{emit:m}){const l=p,d=A,n=m,i=V({get:()=>l.answer,set:e=>{n("update:answer",e)}});return(e,t)=>(u(),c(r(O),{title:e.question.title},{default:b(()=>[S("p",null,M(e.question.question),1),e.question.type===r(d).TEXT?(u(),c(r(T),{key:0,id:e.question.id,modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s),label:"Antwort"},null,8,["id","modelValue"])):f("",!0),e.question.type===r(d).SINGLE_CHOICE?(u(),c(r(I),{key:1,id:e.question.id,modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=s=>i.value=s),label:"Antwort",options:e.question.options||[]},null,8,["id","modelValue","options"])):f("",!0)]),_:1},8,["title"]))}}),G=q({__name:"ActivitySurvey",props:{taskStep:{},sensors:{}},emits:["submit"],setup(p,{emit:m}){const l=p,d=m,n=C({});for(const[e,t]of l.taskStep.questions)n.value[e]=t.clone();const i=async()=>{const t=await l.sensors.get(j.GEOLOCATION).getLocation(),s=[];for(const[w,a]of Object.entries(n.value)){const o=new L;if(o.addMeta("latitude",t.coords.latitude),o.addMeta("longitude",t.coords.longitude),o.addMeta("accuracy",t.coords.accuracy),o.addMeta("questionId",a.id),o.addMeta("type",a.type),o.addMeta("question",a.question),o.addMeta("questionTitle",a.title),a.answer&&typeof a.answer!="object")o.addMeasurement(w,a.answer);else if(a.answer)for(const[g,k]of Object.entries(a.answer))o.addMeasurement(g,k);s.push(o)}d("submit",s)};return(e,t)=>(u(),y("div",null,[v(K,{title:e.taskStep.title,description:e.taskStep.description,instructions:e.taskStep.instructions},null,8,["title","description","instructions"]),S("form",{class:"survey-section",onSubmit:_(i,["prevent"])},[(u(!0),y(N,null,B(Object.keys(n.value),s=>(u(),c(F,{key:s,answer:n.value[s].answer,"onUpdate:answer":w=>n.value[s].answer=w,question:n.value[s]},null,8,["answer","onUpdate:answer","question"]))),128)),v(r(U),{type:"submit",style:{"--color-surface-button":"var(--color-primary)"}},{default:b(()=>[E(" Weiter ")]),_:1})],32)]))}}),h=Q(G,[["__scopeId","data-v-1977c2ba"]]);export{h as default};
