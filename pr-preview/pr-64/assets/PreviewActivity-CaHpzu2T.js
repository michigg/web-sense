import{d as z,h as F,r as u,j as P,o as n,e as m,f as d,u as s,M as L,c as p,D as R,g as f,k as V,v as q,a as l,w as N,F as g,m as K,B as T,p as Z,n as j,_ as U}from"./index-Cs5H5E-P.js";import{u as w}from"./useEntityState-B1VQt2cu.js";import{B as G,M as H,A as J}from"./ButtonSoundAnimation-DcppbUFe.js";import{K as O}from"./KeyValueListItem-NFDGv4DX.js";import{C as Q}from"./ChartNoise-CqsAp63p.js";const h=o=>(Z("data-v-2fa17817"),o=o(),j(),o),W=h(()=>l("label",{for:"recording-time-input"},"Aufnahmezeit in Sekunden",-1)),X={key:1,class:"result-section"},Y=h(()=>l("h2",null,"Ergebnisse",-1)),$=z({__name:"PreviewActivity",props:{sensor:{}},setup(o){const y=o,{busy:A,setBusy:D,setIdle:b,error:S,setError:_}=w();F(async()=>{if(D(),await y.sensor.getPermission()==="denied"){_(new Error("Zugriff auf das Microphone verweigert."));return}b()});const c=u(2),{busy:v,setBusy:M,setIdle:k,error:C,setError:E,clearError:x}=w(),i=u(),B=u();P(v,e=>{B.value=e?"Zeichne auf":"Live Preview starten"},{immediate:!0});const I=async()=>{M(),x();try{const e=y.sensor,t=new H(e);console.info("micAnalyzer created");const r=await t.analyze(c.value);console.info(r);const a=J.getResult(r.getAmplitudeSpectrumList(),e.sampleRate,e.bufferSize);i.value={sampleRate:e.sampleRate,bufferSize:e.bufferSize,windowingFunction:t.analysisConfig.windowingFunction,lowestPerceptibleFrequency:t.analysisConfig.lowestPerceptibleFrequency,highestPerceptibleFrequency:t.analysisConfig.highestPerceptibleFrequency,minDBA:a.minDBA,maxDBA:a.maxDBA,averageDBA:a.averageDBA,minDB:a.minDB,maxDB:a.maxDB,averageDB:a.averageDB}}catch(e){console.error(e),E(e)}finally{k()}};return(e,t)=>(n(),m(g,null,[d(s(L),{error:s(S)||s(C)},null,8,["error"]),s(A)?(n(),p(s(R),{key:0,title:"Sensorvorschau wird geladen"})):f("",!0),W,V(l("input",{id:"recording-time-input","onUpdate:modelValue":t[0]||(t[0]=r=>c.value=r),type:"number",min:"2",step:"1"},null,512),[[q,c.value]]),l("div",null,[d(G,{busy:s(v),info:B.value,onClick:I},null,8,["busy","info"])]),i.value?(n(),m("section",X,[Y,d(s(T),null,{default:N(()=>[(n(!0),m(g,null,K(i.value,(r,a)=>(n(),p(O,{key:a,"key-data":a,"value-data":r},null,8,["key-data","value-data"]))),128))]),_:1}),i.value.averageDBA?(n(),p(Q,{key:0,dba:i.value.averageDBA},null,8,["dba"])):f("",!0)])):f("",!0)],64))}}),ne=U($,[["__scopeId","data-v-2fa17817"]]);export{ne as default};
