import{d as q,s as V,o as u,c,w as b,a as S,t as M,u as r,K as T,h as y,U as I,J as N,z as O,r as A,e as f,g as v,F as B,n as C,b as U,A as _,N as j,I as E,R as L,_ as h}from"./index-DKd2dgYk.js";import{T as K}from"./TaskStepInstructionList-DKjMJuLQ.js";const Q=q({__name:"QuestionSection",props:{question:{},answer:{type:[String,Number,Boolean,Object]}},emits:["update:answer"],setup(p,{emit:m}){const l=p,d=O,a=m,i=V({get:()=>l.answer,set:e=>{a("update:answer",e)}});return(e,t)=>(u(),c(r(N),{title:e.question.title},{default:b(()=>[S("p",null,M(e.question.question),1),e.question.type===r(d).TEXT?(u(),c(r(T),{key:0,id:e.question.id,modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s),label:"Antwort"},null,8,["id","modelValue"])):y("",!0),e.question.type===r(d).SINGLE_CHOICE?(u(),c(r(I),{key:1,id:e.question.id,modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=s=>i.value=s),label:"Antwort",options:e.question.options||[]},null,8,["id","modelValue","options"])):y("",!0)]),_:1},8,["title"]))}}),F=q({__name:"ActivitySurvey",props:{taskStep:{},sensors:{}},emits:["submit"],setup(p,{emit:m}){const l=p,d=m,a=A({});for(const[e,t]of l.taskStep.questions)a.value[e]=t.clone();const i=async()=>{try{const t=await l.sensors.get(E.GEOLOCATION).getLocation(),s=[];for(const[w,n]of Object.entries(a.value)){const o=new L;if(o.addMeta("latitude",t.coords.latitude),o.addMeta("longitude",t.coords.longitude),o.addMeta("accuracy",t.coords.accuracy),o.addMeta("questionId",n.id),o.addMeta("type",n.type),o.addMeta("question",n.question),o.addMeta("questionTitle",n.title),n.answer&&typeof n.answer!="object")o.addMeasurement(w,n.answer);else if(n.answer)for(const[g,k]of Object.entries(n.answer))o.addMeasurement(g,k);s.push(o)}console.log("submit"),d("submit",s)}catch(e){console.error(e)}};return(e,t)=>(u(),f("div",null,[v(K,{title:e.taskStep.title,description:e.taskStep.description,instructions:e.taskStep.instructions},null,8,["title","description","instructions"]),S("form",{class:"survey-section",onSubmit:j(i,["prevent"])},[(u(!0),f(B,null,C(Object.keys(a.value),s=>(u(),c(Q,{key:s,answer:a.value[s].answer,"onUpdate:answer":w=>a.value[s].answer=w,question:a.value[s]},null,8,["answer","onUpdate:answer","question"]))),128)),v(r(_),{type:"submit",style:{"--color-surface-button":"var(--color-primary)"}},{default:b(()=>[U(" Weiter ")]),_:1})],32)]))}}),$=h(F,[["__scopeId","data-v-39638266"]]);export{$ as default};
