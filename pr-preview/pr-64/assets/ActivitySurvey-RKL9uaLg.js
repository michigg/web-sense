import{d as q,p as g,o as u,c,w as b,a as S,t as M,u as r,K as T,i as y,U as I,y as O,Q as A,r as N,e as f,h as v,F as B,m as C,b as U,z as _,A as j,I as E,R as L,_ as Q}from"./index-yB2zXo3B.js";import{T as K}from"./TaskStepInstructionList-cQpjbn5L.js";const h=q({__name:"QuestionSection",props:{question:{},answer:{type:[String,Number,Boolean,Object]}},emits:["update:answer"],setup(p,{emit:m}){const l=p,d=A,n=m,i=g({get:()=>l.answer,set:e=>{n("update:answer",e)}});return(e,t)=>(u(),c(r(O),{title:e.question.title},{default:b(()=>[S("p",null,M(e.question.question),1),e.question.type===r(d).TEXT?(u(),c(r(T),{key:0,id:e.question.id,modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=s=>i.value=s),label:"Antwort"},null,8,["id","modelValue"])):y("",!0),e.question.type===r(d).SINGLE_CHOICE?(u(),c(r(I),{key:1,id:e.question.id,modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=s=>i.value=s),label:"Antwort",options:e.question.options||[]},null,8,["id","modelValue","options"])):y("",!0)]),_:1},8,["title"]))}}),F=q({__name:"ActivitySurvey",props:{taskStep:{},sensors:{}},emits:["submit"],setup(p,{emit:m}){const l=p,d=m,n=N({});for(const[e,t]of l.taskStep.questions)n.value[e]=t.clone();const i=async()=>{const t=await l.sensors.get(E.GEOLOCATION).getLocation(),s=[];for(const[w,a]of Object.entries(n.value)){const o=new L;if(o.addMeta("latitude",t.coords.latitude),o.addMeta("longitude",t.coords.longitude),o.addMeta("accuracy",t.coords.accuracy),o.addMeta("questionId",a.id),o.addMeta("type",a.type),o.addMeta("question",a.question),o.addMeta("questionTitle",a.title),a.answer&&typeof a.answer!="object")o.addMeasurement(w,a.answer);else if(a.answer)for(const[k,V]of Object.entries(a.answer))o.addMeasurement(k,V);s.push(o)}d("submit",s)};return(e,t)=>(u(),f("div",null,[v(K,{title:e.taskStep.title,description:e.taskStep.description,instructions:e.taskStep.instructions},null,8,["title","description","instructions"]),S("form",{class:"survey-section",onSubmit:j(i,["prevent"])},[(u(!0),f(B,null,C(Object.keys(n.value),s=>(u(),c(h,{key:s,answer:n.value[s].answer,"onUpdate:answer":w=>n.value[s].answer=w,question:n.value[s]},null,8,["answer","onUpdate:answer","question"]))),128)),v(r(_),{type:"submit",style:{"--color-surface-button":"var(--color-primary)"}},{default:b(()=>[U(" Weiter ")]),_:1})],32)]))}}),$=Q(F,[["__scopeId","data-v-1977c2ba"]]);export{$ as default};
