import{d as C,h as F,r as u,j as P,o as n,e as c,f as m,u as a,M as I,c as p,D as L,g as B,k as R,v as V,a as i,w as q,F as v,m as N,B as K}from"./index-D0pVmQRR.js";import{u as g}from"./useEntityState-DouDWN44.js";import{B as T,M as Z,A as j}from"./ButtonSoundAnimation-C5I7SYOq.js";import{K as U}from"./KeyValueListItem-BVNtNV0g.js";const G=i("label",{for:"recording-time-input"},"Aufnahmezeit in Sekunden",-1),H={key:1},J=i("h2",null,"Ergebnisse",-1),Y=C({__name:"PreviewActivity",props:{sensor:{}},setup(w){const d=w,{busy:h,setBusy:D,setIdle:b,error:A,setError:S}=g();F(async()=>{if(D(),await d.sensor.getPermission()==="denied"){S(new Error("Zugriff auf das Microphone verweigert."));return}b()});const o=u(1),{busy:y,setBusy:M,setIdle:_,error:E,setError:k,clearError:x}=g(),l=u(),f=u();P(y,e=>{f.value=e?"Zeichne auf":"Live Preview starten"},{immediate:!0});const z=async()=>{M(),x();try{const e=d.sensor,s=new Z(e);console.info("micAnalyzer created");const r=await s.analyze(o.value),t=j.getResult(r.getAmplitudeSpectrumList(),e.sampleRate,e.bufferSize);l.value={sampleRate:e.sampleRate,bufferSize:e.bufferSize,windowingFunction:s.analysisConfig.windowingFunction,lowestPerceptibleFrequency:s.analysisConfig.lowestPerceptibleFrequency,highestPerceptibleFrequency:s.analysisConfig.highestPerceptibleFrequency,minDBA:t.minDBA,maxDBA:t.maxDBA,averageDBA:t.averageDBA,minDB:t.minDB,maxDB:t.maxDB,averageDB:t.averageDB}}catch(e){console.error(e),k(e)}finally{_()}};return(e,s)=>(n(),c(v,null,[m(a(I),{error:a(A)||a(E)},null,8,["error"]),a(h)?(n(),p(a(L),{key:0,title:"Sensorvorschau wird geladen"})):B("",!0),G,R(i("input",{id:"recording-time-input","onUpdate:modelValue":s[0]||(s[0]=r=>o.value=r),type:"number",min:"1",step:"1"},null,512),[[V,o.value]]),i("div",null,[m(T,{busy:a(y),info:f.value,onClick:z},null,8,["busy","info"])]),l.value?(n(),c("section",H,[J,m(a(K),null,{default:q(()=>[(n(!0),c(v,null,N(l.value,(r,t)=>(n(),p(U,{key:t,"key-data":t,"value-data":r},null,8,["key-data","value-data"]))),128))]),_:1})])):B("",!0)],64))}});export{Y as default};
